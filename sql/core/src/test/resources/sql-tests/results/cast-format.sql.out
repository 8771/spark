-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 26


-- !query 0
SELECT CAST('2019-05-28' AS DATE FORMAT)
-- !query 0 schema
struct<>
-- !query 0 output
org.apache.spark.sql.catalyst.parser.ParseException

missing STRING at ')'(line 1, pos 39)

== SQL ==
SELECT CAST('2019-05-28' AS DATE FORMAT)
---------------------------------------^^^


-- !query 1
CREATE TEMPORARY VIEW strings(snull, sdate, stimestamp, sinvalid) AS VALUES (
  null,
  '2019 05 28',
  '2019 05 28 17 03 53 123456',
  'invalid'
)
-- !query 1 schema
struct<>
-- !query 1 output



-- !query 2
SELECT
  CAST(snull AS DATE FORMAT 'yyyy MM dd'),
  CAST(sdate AS DATE FORMAT 'yyyy MM dd'),
  CAST(sdate AS DATE FORMAT 'invalid'),
  CAST(sdate AS DATE FORMAT ''),
  CAST(sinvalid AS DATE FORMAT 'yyyy MM dd')
FROM strings
-- !query 2 schema
struct<snull:date,sdate:date,sdate:date,sdate:date,sinvalid:date>
-- !query 2 output
NULL	2019-05-28	NULL	NULL	NULL


-- !query 3
SELECT
  CAST(snull AS TIMESTAMP FORMAT 'yyyy MM dd HH mm ss SSSSSS'),
  CAST(stimestamp AS TIMESTAMP FORMAT 'yyyy MM dd HH mm ss SSSSSS'),
  CAST(stimestamp AS TIMESTAMP FORMAT 'invalid'),
  CAST(stimestamp AS TIMESTAMP FORMAT ''),
  CAST(sinvalid AS TIMESTAMP FORMAT 'yyyy MM dd HH mm ss SSSSSS')
FROM strings
-- !query 3 schema
struct<snull:timestamp,stimestamp:timestamp,stimestamp:timestamp,stimestamp:timestamp,sinvalid:timestamp>
-- !query 3 output
NULL	2019-05-28 17:03:53.123456	NULL	NULL	NULL


-- !query 4
CREATE TEMPORARY VIEW stringarrays(sadate, satimestamp) AS VALUES (
  array('2019-05-28'),
  array('2019-05-28 17:03:53.123456')
)
-- !query 4 schema
struct<>
-- !query 4 output



-- !query 5
SELECT
  CAST(sadate AS ARRAY<DATE> FORMAT 'yyyy MM dd'),
  CAST(satimestamp AS ARRAY<TIMESTAMP> FORMAT 'yyyy MM dd HH mm ss SSSSSS')
FROM stringarrays
-- !query 5 schema
struct<sadate:array<date>,satimestamp:array<timestamp>>
-- !query 5 output
[2019-05-28]	[2019-05-28 17:03:53.123456]


-- !query 6
CREATE TEMPORARY VIEW stringmaps(smdate, smtimestamp) AS VALUES (
  map('2019-05-28', '2019-05-28'),
  map('2019-05-28 17:03:53.123456', '2019-05-28 17:03:53.123456')
)
-- !query 6 schema
struct<>
-- !query 6 output



-- !query 7
SELECT
  CAST(smdate AS MAP<STRING, DATE> FORMAT 'yyyy MM dd'),
  CAST(smtimestamp AS MAP<STRING, TIMESTAMP> FORMAT 'yyyy MM dd HH mm ss SSSSSS')
FROM stringmaps
-- !query 7 schema
struct<smdate:map<string,date>,smtimestamp:map<string,timestamp>>
-- !query 7 output
{"2019-05-28":2019-05-28}	{"2019-05-28 17:03:53.123456":2019-05-28 17:03:53.123456}


-- !query 8
CREATE TEMPORARY VIEW stringstructs(ssdate, sstimestamp) AS VALUES (
  named_struct('field', '2019-05-28'),
  named_struct('field', '2019-05-28 17:03:53.123456')
)
-- !query 8 schema
struct<>
-- !query 8 output



-- !query 9
SELECT
  CAST(ssdate AS STRUCT<field:DATE> FORMAT 'yyyy MM dd'),
  CAST(sstimestamp AS STRUCT<field:TIMESTAMP> FORMAT 'yyyy MM dd HH mm ss SSSSSS')
FROM stringstructs
-- !query 9 schema
struct<ssdate:struct<field:date>,sstimestamp:struct<field:timestamp>>
-- !query 9 output
{"field":2019-05-28}	{"field":2019-05-28 17:03:53.123456}


-- !query 10
CREATE TEMPORARY VIEW dates(dnull, ddate) AS
SELECT null, to_date('2019-05-28')
-- !query 10 schema
struct<>
-- !query 10 output



-- !query 11
SELECT
  CAST(dnull AS STRING FORMAT 'yyyy MM dd'),
  CAST(ddate AS STRING FORMAT 'yyyy MM dd'),
  CAST(ddate AS STRING FORMAT 'invalid'),
  CAST(ddate AS STRING FORMAT '')
FROM dates
-- !query 11 schema
struct<dnull:string,ddate:string,ddate:string,ddate:string>
-- !query 11 output
NULL	2019 05 28	NULL


-- !query 12
CREATE TEMPORARY VIEW datearrays(da) AS
SELECT array(to_date('2019-05-28'))
-- !query 12 schema
struct<>
-- !query 12 output



-- !query 13
SELECT
  CAST(da AS STRING FORMAT 'yyyy MM dd')
FROM datearrays
-- !query 13 schema
struct<da:string>
-- !query 13 output
[2019-05-28]


-- !query 14
CREATE TEMPORARY VIEW datemaps(dm) AS
SELECT map(to_date('2019-05-29'), to_date('2019-05-28'))
-- !query 14 schema
struct<>
-- !query 14 output



-- !query 15
SELECT
  CAST(dm AS STRING FORMAT 'yyyy MM dd')
FROM datemaps
-- !query 15 schema
struct<dm:string>
-- !query 15 output
[2019-05-29 -> 2019-05-28]


-- !query 16
CREATE TEMPORARY VIEW datestructs(ds) AS
SELECT named_struct('field', to_date('2019-05-28'))
-- !query 16 schema
struct<>
-- !query 16 output



-- !query 17
SELECT
  CAST(ds AS STRING FORMAT 'yyyy MM dd')
FROM datestructs
-- !query 17 schema
struct<ds:string>
-- !query 17 output
[2019-05-28]


-- !query 18
CREATE TEMPORARY VIEW timestamps(tsnull, tsdate) AS
SELECT null, to_timestamp('2019-05-28 17:03:53.123456')
-- !query 18 schema
struct<>
-- !query 18 output



-- !query 19
SELECT
  CAST(tsnull AS STRING FORMAT 'yyyy MM dd HH mm ss SSSSSS'),
  CAST(tsdate AS STRING FORMAT 'yyyy MM dd HH mm ss SSSSSS'),
  CAST(tsdate AS STRING FORMAT 'invalid'),
  CAST(tsdate AS STRING FORMAT '')
FROM timestamps
-- !query 19 schema
struct<tsnull:string,tsdate:string,tsdate:string,tsdate:string>
-- !query 19 output
NULL	2019 05 28 17 03 53 123456	NULL


-- !query 20
CREATE TEMPORARY VIEW timestamparrays(tsa) AS
SELECT array(to_timestamp('2019-05-28 17:03:53.123456'))
-- !query 20 schema
struct<>
-- !query 20 output



-- !query 21
SELECT
  CAST(tsa AS STRING FORMAT 'yyyy MM dd HH mm ss SSSSSS')
FROM timestamparrays
-- !query 21 schema
struct<tsa:string>
-- !query 21 output
[2019-05-28 17:03:53.123456]


-- !query 22
CREATE TEMPORARY VIEW timestampmaps(tsm) AS
SELECT map(to_timestamp('2019-05-28 17:03:53.123456'), to_timestamp('2019-05-28 17:03:53.123456'))
-- !query 22 schema
struct<>
-- !query 22 output



-- !query 23
SELECT
  CAST(tsm AS STRING FORMAT 'yyyy MM dd HH mm ss SSSSSS')
FROM timestampmaps
-- !query 23 schema
struct<tsm:string>
-- !query 23 output
[2019-05-28 17:03:53.123456 -> 2019-05-28 17:03:53.123456]


-- !query 24
CREATE TEMPORARY VIEW timestampstructs(tss) AS
SELECT named_struct('field', to_timestamp('2019-05-28 17:03:53.123456'))
-- !query 24 schema
struct<>
-- !query 24 output



-- !query 25
SELECT
  CAST(tss AS STRING FORMAT 'yyyy MM dd HH mm ss SSSSSS')
FROM timestampstructs
-- !query 25 schema
struct<tss:string>
-- !query 25 output
[2019-05-28 17:03:53.123456]
