-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 7


-- !query 0
CREATE TEMPORARY VIEW department AS SELECT * FROM VALUES
  (0, null, "ROOT"),
  (1, 0, "A"),
  (2, 1, "B"),
  (3, 2, "C"),
  (4, 2, "D"),
  (5, 0, "E"),
  (6, 4, "F"),
  (7, 5, "G")
  AS department(id, parent_department_id, name)
-- !query 0 schema
struct<>
-- !query 0 output



-- !query 1
WITH subdepartment AS (
  SELECT * FROM department WHERE name = 'A'
  UNION ALL
  SELECT * FROM subdepartment
)
SELECT id, parent_department_id, name FROM subdepartment
-- !query 1 schema
struct<id:int,parent_department_id:int,name:string>
-- !query 1 output
1	0	A
1	0	A
1	0	A
1	0	A
1	0	A
1	0	A
1	0	A
1	0	A
1	0	A
1	0	A
1	0	A


-- !query 2
WITH subdepartment AS (
  SELECT * FROM subdepartment
  UNION ALL
  SELECT * FROM department WHERE name = 'A'
)
SELECT id, parent_department_id, name FROM subdepartment
-- !query 2 schema
struct<id:int,parent_department_id:int,name:string>
-- !query 2 output
1	0	A
1	0	A
1	0	A
1	0	A
1	0	A
1	0	A
1	0	A
1	0	A
1	0	A
1	0	A
1	0	A


-- !query 3
WITH MAXIMUM 1 LEVEL RECURSION subdepartment AS (
  SELECT * FROM department WHERE name = 'A'
  UNION ALL
  SELECT * FROM subdepartment
)
SELECT id, parent_department_id, name FROM subdepartment
-- !query 3 schema
struct<id:int,parent_department_id:int,name:string>
-- !query 3 output
1	0	A
1	0	A


-- !query 4
WITH subdepartment AS (
  SELECT * FROM department WHERE name = 'A'
  UNION ALL
  SELECT d.*
  FROM department AS d
  JOIN subdepartment AS sd ON (sd.id = d.parent_department_id)
)
SELECT id, parent_department_id, name FROM subdepartment ORDER BY id
-- !query 4 schema
struct<id:int,parent_department_id:int,name:string>
-- !query 4 output
1	0	A
2	1	B
3	2	C
4	2	D
6	4	F


-- !query 5
WITH subdepartment AS (
  SELECT * FROM department WHERE name = 'A'
  UNION ALL
  SELECT d.*
  FROM department AS d
  JOIN subdepartment AS sd ON (sd.parent_department_id = d.id)
)
SELECT id, parent_department_id, name FROM subdepartment ORDER BY id
-- !query 5 schema
struct<id:int,parent_department_id:int,name:string>
-- !query 5 output
0	NULL	ROOT
1	0	A


-- !query 6
WITH subdepartment AS (
  SELECT DISTINCT * FROM (
    SELECT * FROM department WHERE name = 'A'
    UNION ALL
    SELECT * FROM subdepartment
  )
)
SELECT id, parent_department_id, name FROM subdepartment ORDER BY id
-- !query 6 schema
struct<id:int,parent_department_id:int,name:string>
-- !query 6 output
1	0	A
